##
# nfs - Network Filesystem
# $Header: /opt/cvsroot/doc/tech/nfs,v 1.1 2006/06/08 04:12:41 jick Exp $

= Document =
 * Linux NFS-HOWTO: http://nfs.sourceforge.net/

提供 NFS 服务的程序有三个： 
 * portmapper - 这一程序本身并不直接提供 NFS 服务，但是它将其他计算机发出的调用映
   射到正确的 NFS 守护进程 
 * rpc.nfsd - 这一守护进程把 NFS 请求转化为本地文件系统上的实际请求 
 * rpc.mountd - 这一守护进程为加载和卸载文件系统的请求服务

查看这些程序是否运行:
 # rpcinfo -p 192.168.1.1

配置 NFS 服务器
 * /etc/exports 文件用来指定要与网络上的哪些主机共享哪些目录。示例：
 	/opt *(rw, insecure, sync, no_root_squash)
   * sync: 要求所有文件的写入在写入请求完成之前被提交给硬盘。数据安全一些，因
     为硬盘写入更加频繁。然而，这给系统资源施加了更多压力。默认情况下，这个选
     项是关闭，并且服务器在认为需要是写入数据。
   * no_subtree_check: 这个选项禁止子树检查。对于只读导出的目录或者文件不经常
     改名的目录，子树检查可以提供可靠性。一个很好的例子是 /usr。对于文件经常改
     名的目录，子树检查应该关闭。主目录应该关闭子树检查。子树检查在默认情况下
     是打开的。
   * no_root_squash: 证实并信任客户端的 root 帐号。
 * 当建立 /etc/exports 文件之后，使用 -r 选项运行 exportfs 命令：
   exportfs -r

使用 mount 加载一个导出的文件系统
 * mount servername:/exported/dir /dir/to/mount
   * bg: 后台加载。如果首次加载失败（如服务器关闭），装载进程将把它放在后台并
     继续尝试，知道加载成功。这一方式对于在引导时加载文件系统非常有用，因为如
     果服务器关闭，它可以使系统不至于因为加载不上文件系统而被挂起。
   * intr: 可中断的加载。如果一个进程在一个加载了的分区上等待 I/O，该选项允许
     中断这一进程并放弃 I/O 调用。
   * soft: 在默认情况下，NFS 的操作是“硬的（hard）”。这就是说，在返回调用进程
     之前，它们需要服务器确认完成；而 soft 选项允许 NFS 客户程序在经过 retrans
     次重试之后向调用进程返回一个失败信息。
   * retrans: 为使用 soft 模式加载文件系统指定最大重试次数。
   * wsize: 指定一个跨网络写的字节数。默认值是 8192。慎重，将这个值设置的太高
     或太低均会对系统性能造成负面影响。
   * rsize: 指定一个跨网络读的字节数。同 wsize。
# vim: ft=text:
